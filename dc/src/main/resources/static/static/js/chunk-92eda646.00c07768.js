/*!
 *  build: vue-admin-beautiful 
 *  copyright: chuzhixin 1204505056@qq.com 
 *  time: 2021-3-25 09:05:49
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-92eda646"],{"1c13":function(t,e,a){"use strict";var n=a("c710"),r=a("af5f"),o=a("3f5a"),l=a("004e"),u=a("d0d3"),i=a("303a");n("match",1,(function(t,e,a){return[function(e){var a=l(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,a):new RegExp(e)[t](String(a))},function(t){var n=a(e,t,this);if(n.done)return n.value;var l=r(t),c=String(this);if(!l.global)return i(l,c);var d=l.unicode;l.lastIndex=0;var s,f=[],m=0;while(null!==(s=i(l,c))){var b=String(s[0]);f[m]=b,""===b&&(l.lastIndex=u(c,o(l.lastIndex),d)),m++}return 0===m?null:f}]}))},"24f5":function(t,e,a){},7632:function(t,e,a){"use strict";a.r(e),a.d(e,"getColumnList",(function(){return r})),a.d(e,"getColumns",(function(){return o})),a.d(e,"findByTableIds",(function(){return l})),a.d(e,"doEdit",(function(){return u})),a.d(e,"doSave",(function(){return i})),a.d(e,"doDelete",(function(){return c})),a.d(e,"deleteColumn",(function(){return d})),a.d(e,"renewBatabase",(function(){return s})),a.d(e,"findzdTable",(function(){return f}));var n=a("b775");function r(t){return Object(n["default"])({url:"/tableVsTable/findByTableId",method:"get",params:t})}function o(t){return Object(n["default"])({url:"/column/findByTableId",method:"get",params:t})}function l(t){return Object(n["default"])({url:"/tableVsTable/findByTableIds/"+t,method:"get"})}function u(t){return Object(n["default"])({url:"/column/update",method:"put",data:t})}function i(t){return Object(n["default"])({url:"/column/save",method:"post",data:t})}function c(t){return Object(n["default"])({url:"/column/del",method:"delete",data:t})}function d(t){return Object(n["default"])({url:"/column/deleteColumn",method:"delete",data:t})}function s(t){return Object(n["default"])({url:"/table/renewDatabase",method:"get",params:t})}function f(){return Object(n["default"])({url:"/tableVsTable/findzdTable",method:"get"})}},"9a36":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"relationMapping-container"},[a("el-form",{ref:"ser_form",attrs:{model:t.ser_form,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{lg:6}},[a("el-form-item",{attrs:{label:"存储名",prop:"name"}},[a("el-input",{model:{value:t.ser_form.name,callback:function(e){t.$set(t.ser_form,"name",e)},expression:"ser_form.name"}})],1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{lg:8}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.fetchData}},[t._v("查询")]),a("el-button",{on:{click:function(e){return t.resetForm("ser_form")}}},[t._v("重置")]),a("el-button",{on:{click:t.add}},[t._v(" 新建映射关系 ")])],1)],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"存储名",width:"200"}}),a("el-table-column",{attrs:{prop:"name_zh",label:"存储中文名",width:"200"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.edit(e.row)}}},[t._v(" 修改 ")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.cqsj(e.row)}}},[t._v(" 抽取数据 ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":t.pageInfo.pageNum,"page-size":t.pageInfo.pageSize,layout:"total, prev, pager, next",total:t.pageInfo.total},on:{"update:currentPage":function(e){return t.$set(t.pageInfo,"pageNum",e)},"update:current-page":function(e){return t.$set(t.pageInfo,"pageNum",e)},"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"对照映射",visible:t.dialogVisible,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"ysForm",attrs:{model:t.ysForm,"label-width":"60px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"产品"}},[a("el-input",{attrs:{value:"dc",disabled:""}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"产品"}},[a("el-input",{attrs:{value:"dc",disabled:""}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源表名"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:t.getYbZd},model:{value:t.form.from_table_id,callback:function(e){t.$set(t.form,"from_table_id",e)},expression:"form.from_table_id"}},t._l(t.standard,(function(e,n){return a("el-option",{key:n,attrs:{label:e.name_zh,value:e.id},nativeOn:{click:function(a){return t.setYb(e)}}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"维表名"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:t.getwbZd},model:{value:t.form.to_table_id,callback:function(e){t.$set(t.form,"to_table_id",e)},expression:"form.to_table_id"}},t._l(t.wbList,(function(e,n){return a("el-option",{key:n,attrs:{label:e.name_zh,value:e.id},nativeOn:{click:function(a){return t.setWb(e)}}})})),1)],1)],1)],1)],1),a("el-table",{attrs:{data:t.gridData}},[a("el-table-column",{attrs:{prop:"from_table_column_id",label:"源表字段"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{size:"mini",filterable:"",clearable:""},model:{value:e.row.from_table_column_id,callback:function(a){t.$set(e.row,"from_table_column_id",a)},expression:"scope.row.from_table_column_id"}},t._l(t.options,(function(n,r){return a("el-option",{key:r,attrs:{label:n.from_table_column_zh,value:n.from_table_column_id},nativeOn:{click:function(a){return t.setFromColumn(n,e.$index)}}})})),1)]}}])}),a("el-table-column",{attrs:{prop:"to_table_column_zh",label:"维表字段"}})],1),a("el-card",{staticStyle:{display:"none"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.sql,callback:function(e){t.sql=e},expression:"sql"}})],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("标准维SQL")])]),a("el-input",{attrs:{type:"textarea"},model:{value:t.sql1,callback:function(e){t.sql1=e},expression:"sql1"}})],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("产品维SQL")])]),a("el-input",{attrs:{type:"textarea"},model:{value:t.sql2,callback:function(e){t.sql2=e},expression:"sql2"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{on:{click:t.test}},[t._v("测 试")]),a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v(" 保 存 ")])],1)],1)],1)},r=[],o=(a("422c"),a("5c4c"),a("4798"),a("d8f4"),a("1c13"),a("1f90"),a("6a61"),a("2e91")),l=a("ad8f"),u=a("c3ec"),i=a("7632"),c=a("9d1a"),d=a("d434"),s={data:function(){return{pageInfo:{total:0,pageSize:8,pageNum:1},value2:"",dialogVisible:!1,ser_form:{name:""},options:[],ysForm:{bzb:"",cpb:""},tableData:[],gridData:[],form:{from_table_id:"",from_table_name:"",from_table_name_zh:"",to_table_id:"",to_table_name:""},standard:[],wbList:[],sql:"",sql1:"",sql2:"",id:"",id2:""}},watch:{gridData:{handler:function(t,e){var a="",n="";_(t).forEach((function(t){a+=t.to_table_column+",",n+=t.from_table_column+","})),this.sql="("+a.substr(0,a.length-1)+")\r\nselect "+n.substr(0,n.length-1)+" from "+this.form.from_table_name},deep:!0}},created:function(){this.getStandard(),this.getWb(),this.fetchData()},methods:{cqsj:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["extractDateWb"])(t);case 2:n=a.sent,n.t,r=n.state,o=n.msg,e.$message({type:r,message:o});case 7:case"end":return a.stop()}}),a)})))()},fetchData:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=JSON.parse(JSON.stringify(t.pageInfo)),delete a["total"],e.next=4,Object(d["findDcProcedure"])(_.assign(a,t.ser_form));case 4:n=e.sent,r=n.t,t.tableData=r.list,t.pageInfo.total=r.total,t.pageInfo.pageNum=r.pageNum;case 9:case"end":return e.stop()}}),e)})))()},add:function(){this.dialogVisible=!0,this.gridData=[],this.sql1="",this.sql2="",this.form.from_table_id="",this.form.from_table_name="",this.form.from_table_name_zh="",this.form.to_table_id="",this.form.to_table_name="",this.id=null,this.id2=null},handleCurrentChange:function(t){this.pageNum=t,this.fetchData()},edit:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["findWBById"])({id:t.id});case 2:n=a.sent,r=n.t,e.form.from_table_id=r.table_main_id,e.getYbZd(e.form.from_table_id),e.form.from_table_name=r.table_mian_name,e.form.from_table_name_zh=r.table_mian_name_zh,e.sql1=r.map_sql,e.sql2=r.where_sql,e.form.to_table_id=r.bztable,e.form.to_table_name=r.name_zh.match(/数据到(\S*)的/)[1],e.dialogVisible=!0,e.id=r.id,e.id2=r.join_sql,e.gridData=r.dcTableVsTables;case 16:case"end":return a.stop()}}),a)})))()},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))},resetForm:function(t){this.$refs[t].resetFields(),this.fetchData()},setYb:function(t){this.form.from_table_name=t.name,this.form.from_table_name_zh=t.name_zh},setWb:function(t){this.form.to_table_name=t.name},setFromColumn:function(t,e){this.gridData[e].from_table_column=t.from_table_column,this.gridData[e].from_table_id=t.from_table_id,this.gridData[e].from_table_column_zh=t.from_table_column_zh},getStandard:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["getTable"])({type:1});case 2:a=e.sent,n=a.t,t.standard=n.list;case 5:case"end":return e.stop()}}),e)})))()},getWb:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["findWB"])({pageSize:0,pageNum:1,name:""});case 2:a=e.sent,n=a.t,t.wbList=n;case 5:case"end":return e.stop()}}),e)})))()},getwbZd:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["findWBBytableId"])({tableId:t});case 2:n=a.sent,r=n.t,_(r.dcColumnList).forEach((function(t){e.gridData.push({dc_relation_replace_type_id:"",from_table_column:"",from_table_column_id:"",from_table_column_zh:"",from_table_id:"",procedure_id:"",relation_replace_sql:"",relation_replace_table_id:"",to_table_column:t.column_name,to_table_column_id:t.id,to_table_column_zh:t.column_name_zh,to_table_id:t.table_id,to_table_name:t.table_name,id:""})}));case 5:case"end":return a.stop()}}),a)})))()},getYbZd:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["findByTableIds"])(t);case 2:n=a.sent,r=n.t,e.options=r;case 5:case"end":return a.stop()}}),a)})))()},test:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,r,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={dcTableVsTables:t.gridData,id:t.id,from_product_id:21,to_product_id:22,isparam:0,name:"ETL_Dc_otsw_"+t.form.from_table_name+"_to_"+t.form.to_table_name,map_sql:t.sql,name_zh:"从源表"+t.form.from_table_name+"中抽取数据到"+t.form.to_table_name+"的标准维表中",table_main_id:t.form.from_table_id,table_mian_name:t.form.from_table_name,table_mian_name_zh:t.form.from_table_name_zh,type_id:4},n={dcTableVsTables:t.gridData,id:t.id2?Number(t.id2):null,from_product_id:21,to_product_id:12,isparam:0,name:"ETL_Dc_otaw_"+t.form.from_table_name+"_to_"+t.form.to_table_name,map_sql:t.sql,name_zh:"从源表"+t.form.from_table_name+"中抽取数据到"+t.form.to_table_name+"的HBI维表中",table_main_id:t.form.from_table_id,table_mian_name:t.form.from_table_name,table_mian_name_zh:t.form.from_table_name_zh,type_id:8},r=[a,n],e.next=5,Object(c["tesWBtProc"])(r);case 5:o=e.sent,l=o.t,t.sql1=l[a.name],t.sql2=l[n.name];case 9:case"end":return e.stop()}}),e)})))()},save:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,r,o,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={dcTableVsTables:t.gridData,to_table_id:t.form.to_table_id,id:t.id?t.id:null,from_product_id:21,to_product_id:22,isparam:0,name:"ETL_Dc_otsw_"+t.form.from_table_name+"_to_"+t.form.to_table_name,map_sql:t.sql,name_zh:"从源表"+t.form.from_table_name+"中抽取数据到"+t.form.to_table_name+"的标准维表中",table_main_id:t.form.from_table_id,table_mian_name:t.form.from_table_name,table_mian_name_zh:t.form.from_table_name_zh,type_id:4,content:t.sql1},n={dcTableVsTables:t.gridData,id:t.id2?Number(t.id2):null,from_product_id:21,to_product_id:12,isparam:0,name:"ETL_Dc_otaw_"+t.form.from_table_name+"_to_"+t.form.to_table_name,name_zh:"从源表"+t.form.from_table_name+"中抽取数据到"+t.form.to_table_name+"的HBI维表中",table_main_id:t.form.from_table_id,table_mian_name:t.form.from_table_name,table_mian_name_zh:t.form.from_table_name_zh,type_id:8,content:t.sql2},r=[a,n],e.next=5,Object(c["saveWB"])(r);case 5:o=e.sent,o.t,l=o.state,u=o.msg,t.$message({type:l,message:u}),t.dialogVisible=!1,t.fetchData();case 12:case"end":return e.stop()}}),e)})))()}}},f=s,m=(a("d030"),a("c701")),b=Object(m["a"])(f,n,r,!1,null,null,null);e["default"]=b.exports},"9d1a":function(t,e,a){"use strict";a.r(e),a.d(e,"getList",(function(){return r})),a.d(e,"getTableVsTableList",(function(){return o})),a.d(e,"testProc",(function(){return l})),a.d(e,"tesWBtProc",(function(){return u})),a.d(e,"saveWB",(function(){return i})),a.d(e,"getTable",(function(){return c})),a.d(e,"doEdit",(function(){return d})),a.d(e,"saveVs",(function(){return s})),a.d(e,"doDelete",(function(){return f}));var n=a("b775");function r(t){return Object(n["default"])({url:"/table/findAll",method:"get",params:t})}function o(t){return Object(n["default"])({url:"/tableVsTable/findById",method:"get",params:t})}function l(t){return Object(n["default"])({url:"/tableVsTable/testProc",method:"put",data:t})}function u(t){return Object(n["default"])({url:"/tableVsTable/tesWBtProc",method:"put",data:t})}function i(t){return Object(n["default"])({url:"/tableVsTable/saveWB",method:"post",data:t})}function c(t){return Object(n["default"])({url:"/table/findByType",method:"get",params:t})}function d(t){return Object(n["default"])({url:"/table/update",method:"put",data:t})}function s(t){return Object(n["default"])({url:"/tableVsTable/save",method:"post",data:t})}function f(t){return Object(n["default"])({url:"/table/del",method:"delete",data:t})}},ad8f:function(t,e,a){"use strict";a.r(e),a.d(e,"getList",(function(){return r})),a.d(e,"renewDatabase",(function(){return o})),a.d(e,"findWBBytableId",(function(){return l})),a.d(e,"getTable",(function(){return u})),a.d(e,"doEdit",(function(){return i})),a.d(e,"doSave",(function(){return c})),a.d(e,"doDelete",(function(){return d})),a.d(e,"deleteTable",(function(){return s})),a.d(e,"getByProductId",(function(){return f}));var n=a("b775");function r(t){return Object(n["default"])({url:"/table/findAll",method:"get",params:t})}function o(t){return Object(n["default"])({url:"/table/renewDatabase",method:"get",params:t})}function l(t){return Object(n["default"])({url:"/table/findWBBytableId",method:"get",params:t})}function u(t){return Object(n["default"])({url:"/table/findByType",method:"get",params:t})}function i(t){return Object(n["default"])({url:"/table/update",method:"put",data:t})}function c(t){return Object(n["default"])({url:"/table/save",method:"post",data:t})}function d(t){return Object(n["default"])({url:"/table/del",method:"delete",data:t})}function s(t){return Object(n["default"])({url:"/table/deleteTable",method:"delete",data:t})}function f(t){return Object(n["default"])({url:"/table/findByProductId",method:"get",params:t})}},c3ec:function(t,e,a){"use strict";a.r(e),a.d(e,"findWB",(function(){return r})),a.d(e,"findWBById",(function(){return o})),a.d(e,"insertDv",(function(){return l})),a.d(e,"updateDv",(function(){return u}));var n=a("b775");function r(t){return Object(n["default"])({url:"/table/findWB",method:"get",params:t})}function o(t){return Object(n["default"])({url:"/tableVsTable/findWBById",method:"get",params:t})}function l(t){return Object(n["default"])({url:"/dv/insert",method:"post",data:t})}function u(t){return Object(n["default"])({url:"/dv/update",method:"put",data:t})}},d030:function(t,e,a){"use strict";a("24f5")},d434:function(t,e,a){"use strict";a.r(e),a.d(e,"testProc",(function(){return r})),a.d(e,"findAllOts",(function(){return o})),a.d(e,"findDcProcedure",(function(){return l})),a.d(e,"saveProc",(function(){return u})),a.d(e,"findAllProc",(function(){return i})),a.d(e,"updateProc",(function(){return c})),a.d(e,"getExtract",(function(){return d})),a.d(e,"extractDate",(function(){return s})),a.d(e,"extractDateWb",(function(){return f}));var n=a("b775");function r(t){return Object(n["default"])({url:"/dcProcedure/testProc",method:"put",data:t})}function o(t){return Object(n["default"])({url:"/dcProcedure/findAllOts",method:"get",params:t})}function l(t){return Object(n["default"])({url:"/dcProcedure/findByName",method:"get",params:t})}function u(t){return Object(n["default"])({url:"/dcProcedure/save",method:"post",data:t})}function i(t){return Object(n["default"])({url:"/dcProcedure/findAll",method:"get",data:t})}function c(t){return Object(n["default"])({url:"/dcProcedure/update",method:"get",data:t})}function d(t){return Object(n["default"])({url:"/dcProcedure/getExtract",method:"post",data:t})}function s(t){return Object(n["default"])({url:"/dcProcedure/extractDate",method:"post",data:t})}function f(t){return Object(n["default"])({url:"/dcProcedure/extractDateWb",method:"post",data:t})}}}]);