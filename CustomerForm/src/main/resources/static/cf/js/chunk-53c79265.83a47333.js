(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53c79265"],{5540:function(e,t,i){"use strict";i("8437")},8437:function(e,t,i){},"8a2a":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"field-props-container"},[e.showingInDialog?e._e():i("el-header",{staticClass:"field-props-header"},[e._v(" [多对多引用]字段属性设置 ")]),i("el-main",{staticClass:"field-props-pane"},[i("el-form",{ref:"editorForm",attrs:{model:e.fieldProps,rules:e.rules,"label-position":"left","label-width":"220px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"字段名称",prop:"name"}},[i("el-input",{attrs:{disabled:1!==e.fieldState},model:{value:e.fieldProps.name,callback:function(t){e.$set(e.fieldProps,"name",t)},expression:"fieldProps.name"}})],1),i("el-form-item",{attrs:{label:"显示名称",prop:"label"}},[i("el-input",{model:{value:e.fieldProps.label,callback:function(t){e.$set(e.fieldProps,"label",t)},expression:"fieldProps.label"}})],1),i("el-form-item",{attrs:{label:"引用实体设置"}},[i("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-plus"},on:{click:e.addRefEntity}},[e._v(" 添加 ")])],1),i("hr",{staticStyle:{border:"0","border-top":"1px dotted #cccccc"}}),e._l(e.referenceList,(function(t,l){return i("el-form-item",{key:l,attrs:{label:"引用实体"+(l+1)}},[i("el-input",{attrs:{readonly:""},model:{value:t.refEntityAndFields,callback:function(i){e.$set(t,"refEntityAndFields",i)},expression:"refEntity.refEntityAndFields"}},[t.currentRefEntity?i("el-button",{attrs:{slot:"append",icon:"el-icon-close",title:"清除"},on:{click:function(t){return e.clearReferTo(l)}},slot:"append"}):e._e(),i("el-button",{attrs:{slot:"append",icon:"el-icon-search",title:"选择"},on:{click:function(t){return e.showRefEntitySettingDialog(l)}},slot:"append"}),i("el-button",{attrs:{slot:"append",icon:"el-icon-delete",title:"删除"},on:{click:function(t){return e.deleteRefEntity(l)}},slot:"append"})],1)],1)})),i("hr",{staticStyle:{border:"0","border-top":"1px dotted #cccccc",margin:"-8px 0 12px"}}),i("el-form-item",{attrs:{label:"搜索弹窗宽度（单位：像素）："}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{type:"number"},model:{value:e.fieldProps.fieldViewModel.searchDialogWidth,callback:function(t){e.$set(e.fieldProps.fieldViewModel,"searchDialogWidth",e._n(t))},expression:"fieldProps.fieldViewModel.searchDialogWidth"}})],1),i("el-form-item",{attrs:{label:"字段校验函数(可多选)",prop:"fieldViewModel.validators"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","allow-create":"",filterable:"","default-first-option":"","popper-append-to-body":!1},model:{value:e.fieldProps.fieldViewModel.validators,callback:function(t){e.$set(e.fieldProps.fieldViewModel,"validators",t)},expression:"fieldProps.fieldViewModel.validators"}},e._l(e.validators,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"是否允许空值"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.nullable,callback:function(t){e.$set(e.fieldProps,"nullable",t)},expression:"fieldProps.nullable"}},[i("el-radio",{attrs:{label:!0}},[e._v("是")]),i("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{label:"新建记录时允许修改字段"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.creatable,callback:function(t){e.$set(e.fieldProps,"creatable",t)},expression:"fieldProps.creatable"}},[i("el-radio",{attrs:{label:!0}},[e._v("是")]),i("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{label:"更新记录时允许修改字段"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.updatable,callback:function(t){e.$set(e.fieldProps,"updatable",t)},expression:"fieldProps.updatable"}},[i("el-radio",{attrs:{label:!0}},[e._v("是")]),i("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1),i("hr",{staticStyle:{border:"0","border-top":"1px dotted #cccccc"}}),i("el-form-item",[i("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",size:"medium"},on:{click:e.saveField}},[e._v(" 保存字段 ")]),e.showingInDialog?i("el-button",{attrs:{size:"medium"},on:{click:e.cancelSave}},[e._v(" 取消 ")]):e._e()],1)],2)],1),i("el-dialog",{staticClass:"refer-entity-dialog",attrs:{title:"引用实体设置",visible:e.showRefEntityDialogFlag,"append-to-body":!0,width:"560px"},on:{"update:visible":function(t){e.showRefEntityDialogFlag=t}}},[i("el-container",[i("el-header",[i("el-input",{attrs:{size:"small",placeholder:"请选择引用实体"},model:{value:e.refEntityFullName,callback:function(t){e.refEntityFullName=t},expression:"refEntityFullName"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search",title:"选择"},on:{click:e.showEntityListDialog},slot:"append"})],1)],1),i("el-main",[i("div",[i("div",{staticStyle:{"margin-bottom":"6px"}},[e._v("选择实体搜索列表字段：")]),i("el-card",{attrs:{shadow:"never"}},[e.fieldItems.length<=0?i("div",{staticStyle:{"font-style":"italic"}},[e._v(" 暂无字段可选 ")]):e._e(),e._l(e.fieldItems,(function(t,l){return i("el-checkbox",{key:l,on:{change:function(i){return e.setRefEntityListField(t,i)}}},[e._v(" "+e._s(t.label)+"("+e._s(t.name)+") ")])}))],2)],1),i("div",[i("div",{staticStyle:{margin:"20px 0 6px"}},[e._v("已选择的显示字段：")]),i("el-card",{attrs:{shadow:"never"}},[e.selectedFieldItems.length<=0?i("div",{staticStyle:{"font-style":"italic"}},[e._v(" 未选择显示字段 ")]):e._e(),e._l(e.selectedFieldItems,(function(t,l){return i("div",{key:l},[e._v(" "+e._s(t.label)+"("+e._s(t.name)+") ")])}))],2)],1)])],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.showRefEntityDialogFlag=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.setRefEntity}},[e._v("确 定")])],1)],1),i("el-dialog",{ref:"entityListDlg",staticClass:"entity-list-dialog",attrs:{title:"选择引用实体",visible:e.showEntityListDialogFlag,"append-to-body":!0,width:"560px"},on:{"update:visible":function(t){e.showEntityListDialogFlag=t}}},[i("SimpleTable",{attrs:{"show-pagination":!1,"show-check-box":!1,"table-size":"mini",columns:e.columns,data:e.tableData,"max-height":420}},[i("el-table-column",{attrs:{slot:"table_operation",align:"center",label:"",width:"150",resizable:!1},slot:"table_operation",scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{icon:"el-icon-check"},on:{click:function(i){return e.selectEntity(t.row)}}},[e._v(" 选择 ")])]}}])})],1)],1)],1)},s=[],n=(i("a9e3"),i("e9c4"),i("b0c0"),i("a434"),i("d3b7"),i("159b"),i("d364")),a=i("ca00"),r={name:"ReferenceListWidgetEditor",props:{entity:String,fieldName:String,showingInDialog:Boolean,fieldState:{type:Number,default:n["a"].NEW}},data:function(){return{fieldProps:{name:"",label:"",type:"ReferenceList",defaultMemberOfListFlag:!1,nullable:!1,creatable:!0,updatable:!0,fieldViewModel:{searchDialogWidth:520,validators:[]},referTo:[],referenceSetting:[]},rules:{name:[{required:!0,message:"请输入字段名称",trigger:"blur"},{pattern:/^[a-z]+[A-Za-z\d]*$/,message:"请以小写英文字母开头，中间可输入字母或数字，禁止中文",trigger:"blur"},{min:2,max:30,message:"请输入至少两个字符",trigger:"blur"}],label:[{required:!0,message:"请输入显示名称",trigger:"blur"},{pattern:/^[A-Za-z\d\u4e00-\u9fa5]+[_-]*/,message:"请以中文、英文字母、数字开头，中间可输入下划线或横杠",trigger:"blur"},{min:2,max:30,message:"请输入至少两个字符",trigger:"blur"}]},validators:[],refEntityIndex:-1,referenceList:[{currentRefEntity:"",selectedFieldItems:[],refEntityAndFields:""}],refEntityName:"",refEntityLabel:"",refEntityFullName:"",showRefEntityDialogFlag:!1,showEntityListDialogFlag:!1,fieldItems:[],selectedFieldItems:[],columns:[{prop:"name",label:"实体名称",width:"150",align:"center"},{prop:"label",label:"显示名称",width:"200",align:"center",formatter:this.formatter}],tableData:[]}},mounted:function(){this.fieldState===n["a"].EDIT&&this.getFieldProps()},methods:{getFieldProps:function(){},readFieldProps:function(e){Object(a["copyObj"])(this.fieldProps,e),this.fieldProps.fieldViewModel||(this.fieldProps["fieldViewModel"]={searchDialogWidth:520}),e.entityCode&&(this.fieldProps.entityCode=e.entityCode)},saveField:function(){var e=!0;this.$refs["editorForm"].validate((function(t){if(!t)return e=!1,!1})),e&&(this.fieldProps.referTo.length<=0||!this.fieldProps.referenceSetting?this.$message.error("请设置引用实体！"):this.fieldProps.type="ReferenceList")},cancelSave:function(){this.$emit("cancelSave")},clearReferTo:function(e){this.referenceList[e].currentRefEntity="",this.referenceList[e].refEntityAndFields="",this.buildReferToAndReferenceSetting()},showRefEntitySettingDialog:function(e){this.showRefEntityDialogFlag=!0,this.refEntityIndex=e,this.refEntityName="",this.refEntityLabel="",this.refEntityFullName="",this.fieldItems.length=0,this.selectedFieldItems.length=0},setRefEntity:function(){if(this.selectedFieldItems.length<=0)this.$message.info("请至少选择一个显示字段！");else{for(var e=this.refEntityLabel+"[",t=0;t<this.selectedFieldItems.length;t++)e+=this.selectedFieldItems[t].label+",";e+="]",this.referenceList[this.refEntityIndex].refEntityAndFields=e,this.referenceList[this.refEntityIndex].currentRefEntity=this.refEntityName,this.referenceList[this.refEntityIndex].selectedFieldItems=JSON.parse(JSON.stringify(this.selectedFieldItems)),this.buildReferToAndReferenceSetting(),this.showRefEntityDialogFlag=!1}},showEntityListDialog:function(){this.tableData.length=0},selectEntity:function(e){this.refEntityName=e.name,this.refEntityLabel=e.label,this.refEntityFullName=this.refEntityLabel+"("+this.refEntityName+")",this.showEntityListDialogFlag=!1,this.fieldItems.length=0},setRefEntityListField:function(e,t){if(t)this.selectedFieldItems.push(e);else for(var i=this.selectedFieldItems.length-1;i>=0;i--)this.selectedFieldItems[i].name===e.name&&this.selectedFieldItems.splice(i,1)},addRefEntity:function(){this.referenceList.push({currentRefEntity:"",selectedFieldItems:[],refEntityAndFields:""})},deleteRefEntity:function(e){this.referenceList.splice(e,1),this.buildReferToAndReferenceSetting()},buildReferToAndReferenceSetting:function(){var e=this;this.fieldProps.referTo.length=0,this.fieldProps.referenceSetting.length=0,this.referenceList.forEach((function(t){if(t.currentRefEntity&&t.selectedFieldItems){var i=[];t.selectedFieldItems.forEach((function(e){i.push(e.name)})),e.fieldProps.referTo.push(t.currentRefEntity),e.fieldProps.referenceSetting.push({entityName:t.currentRefEntity,fieldList:i})}}))}}},o=r,d=(i("5540"),i("2877")),c=Object(d["a"])(o,l,s,!1,null,"67680b81",null);t["default"]=c.exports},d364:function(e,t,i){"use strict";var l=1,s=2;t["a"]={NEW:l,EDIT:s}}}]);
//# sourceMappingURL=chunk-53c79265.83a47333.js.map