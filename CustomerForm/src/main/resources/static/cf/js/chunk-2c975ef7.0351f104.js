(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c975ef7"],{"849d":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"field-props-container"},[e.showingInDialog?e._e():i("el-header",{staticClass:"field-props-header"},[e._v(" [单选项]字段属性设置 ")]),i("el-main",{staticClass:"field-props-pane"},[i("el-form",{ref:"editorForm",attrs:{model:e.fieldProps,rules:e.rules,"label-position":"left","label-width":"220px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"字段名称",prop:"name"}},[i("el-input",{attrs:{disabled:1!==e.fieldState},model:{value:e.fieldProps.name,callback:function(t){e.$set(e.fieldProps,"name",t)},expression:"fieldProps.name"}})],1),i("el-form-item",{attrs:{label:"显示名称",prop:"label"}},[i("el-input",{model:{value:e.fieldProps.label,callback:function(t){e.$set(e.fieldProps,"label",t)},expression:"fieldProps.label"}})],1),i("el-form-item",{attrs:{label:"字段长度（不超过6位）"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:e.fieldProps.field_length,callback:function(t){e.$set(e.fieldProps,"field_length",t)},expression:"fieldProps.field_length"}})],1),i("el-form-item",{attrs:{label:"下拉选项"}},[i("el-radio-group",{on:{change:function(t){1==e.fieldProps.dictortsql?e.fieldProps.field_sql="":e.fieldProps.data_code="",e.fieldProps.codename_allshow=0}},model:{value:e.fieldProps.dictortsql,callback:function(t){e.$set(e.fieldProps,"dictortsql",t)},expression:"fieldProps.dictortsql"}},[i("el-radio",{attrs:{label:1}},[e._v("字典")]),i("el-radio",{attrs:{label:2}},[e._v("自定义SQL")])],1)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.fieldProps.dictortsql,expression:"fieldProps.dictortsql == 1"}],attrs:{label:"字典"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":e.getDtList,loading:e.loading},model:{value:e.fieldProps.data_code,callback:function(t){e.$set(e.fieldProps,"data_code",t)},expression:"fieldProps.data_code"}},[e._l(e.dtList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name_zh,value:e.id+""}})})),i("el-button",{attrs:{slot:"prefix",type:"text",icon:"el-icon-refresh"},on:{click:e.refresh},slot:"prefix"})],2)],1),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.fieldProps.dictortsql,expression:"fieldProps.dictortsql == 2"}],attrs:{label:"自定义SQL"}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入SQL",type:"textarea"},model:{value:e.fieldProps.field_sql,callback:function(t){e.$set(e.fieldProps,"field_sql",t)},expression:"fieldProps.field_sql"}}),e._v(" 案例：select distinct dm as val,mc as name from ... ")],1),i("el-form-item",{attrs:{label:"是否允许空值"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.is_null,callback:function(t){e.$set(e.fieldProps,"is_null",t)},expression:"fieldProps.is_null"}},[i("el-radio",{attrs:{label:1}},[e._v("是")]),i("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{label:"允许修改字段"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.is_edit,callback:function(t){e.$set(e.fieldProps,"is_edit",t)},expression:"fieldProps.is_edit"}},[i("el-radio",{attrs:{label:1}},[e._v("是")]),i("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),2==e.fieldProps.dictortsql?i("el-form-item",{attrs:{label:"是否显示编码"}},[i("el-radio-group",{staticStyle:{float:"right"},model:{value:e.fieldProps.codename_allshow,callback:function(t){e.$set(e.fieldProps,"codename_allshow",t)},expression:"fieldProps.codename_allshow"}},[i("el-radio",{attrs:{label:1}},[e._v("是")]),i("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1):e._e(),i("hr",{staticStyle:{border:"0","border-top":"1px dotted #cccccc"}}),i("el-form-item",[i("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary",size:"medium"},on:{click:e.saveField}},[e._v(" 保存字段 ")]),e.showingInDialog?i("el-button",{attrs:{size:"medium"},on:{click:e.cancelSave}},[e._v(" 取消 ")]):e._e()],1)],1)],1)],1)},n=[],l=i("1da1"),s=(i("96cf"),i("a9e3"),i("498a"),i("b0c0"),i("a15b"),i("d3b7"),i("159b"),i("a434"),i("b705")),r=i("ca00"),o=i("d364"),d=i("365c"),c=i("9eab"),u={name:"OptionWidgetEditor",mixins:[c["a"]],props:{entity:Object,fieldName:String,showingInDialog:Boolean,fieldState:{type:Number,default:o["a"].NEW}},data:function(){return{loading:!1,dtList:[],fieldProps:{data_code:"",default_show:0,facttable_id:"",field_length:255,field_sql:"",file_path:"",file_size:0,image_path:"",is_edit:1,is_mainfield:0,is_null:1,is_system:0,label:"",name:"",num_length:0,order_number:0,table_name:"",type:5,verifiable:"",dictortsql:1,codename_allshow:0},optionItems:[],hoverIdx:-1,validators:[],rules:{name:{required:!0,message:"请输入字段名",trigger:"blur"},label:{required:!0,message:"请输入字段显示名称",trigger:"blur"}}}},mounted:function(){this.fieldState===o["a"].EDIT&&this.getFieldProps()},methods:{refresh:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var i,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["z"])();case 2:i=t.sent,a=i.state,n=i.msg,e.$message({type:a,message:n});case 6:case"end":return t.stop()}}),t)})))()},getDtList:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function i(){var a,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.loading=!0,i.next=3,Object(d["i"])({name:e.trim()});case 3:a=i.sent,n=a.t,t.dtList=n,t.loading=!1;case 7:case"end":return i.stop()}}),i)})))()},getFieldProps:function(){},readFieldProps:function(e){Object(r["copyObj"])(this.fieldProps,e),e.entityCode&&(this.fieldProps.entityCode=e.entityCode)},saveField:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=!0,e.fieldProps.table_name=e.entity.name,e.fieldProps.facttable_id=e.entity.id,e.fieldProps.verifiable=e.validators.join(","),e.$refs["editorForm"].validate((function(e){if(!e)return i=!1,!1})),i){t.next=7;break}return t.abrupt("return");case 7:e.modifyOldField(e.fieldProps,e.fieldState);case 8:case"end":return t.stop()}}),t)})))()},cancelSave:function(){this.$emit("cancelSave")},validateOption:function(e,t){var i=!0;return this.optionItems.forEach((function(a,n){a.label===e&&n!==t&&(i=!1)})),i},getOptionMaxValue:function(){var e=0;return this.optionItems.forEach((function(t){t.value>e&&(e=t.value)})),e},addOption:function(){var e=this;this.$prompt("请输入选项名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[A-Za-z\u4e00-\u9fa5\d]+$/,inputErrorMessage:"输入不正确"}).then((function(t){var i=t.value;if(e.validateOption(i,-1)){var a=e.getOptionMaxValue()+1,n={label:i,value:a,saved:!1};e.optionItems.push(n),e.$nextTick((function(){console.log("Updated!")}))}else e.$message.warning("选项已存在")})).catch((function(){s["Message"].info("已取消")}))},insertOption:function(e){var t=this;this.$prompt("请输入选项名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[A-Za-z\u4e00-\u9fa5\d]+$/,inputErrorMessage:"输入不正确"}).then((function(i){var a=i.value;if(t.validateOption(a,-1)){var n=t.getOptionMaxValue()+1,l={label:a,value:n,saved:!1};t.optionItems.splice(e+1,0,l),t.$nextTick((function(){console.log("Updated!")}))}else t.$message.warning("选项已存在")})).catch((function(){s["Message"].info("已取消")}))},upOption:function(e){if(0!==e){var t=this.optionItems[e];this.$set(this.optionItems,e,this.optionItems[e-1]),this.$set(this.optionItems,e-1,t)}else this.$message.info("已到最上")},downOption:function(e){if(console.log("length: "+this.optionItems.length+", current idx: "+e),e!==this.optionItems.length-1){var t=this.optionItems[e];this.$set(this.optionItems,e,this.optionItems[e+1]),this.$set(this.optionItems,e+1,t)}else this.$message.info("已到最下")},editOption:function(e){var t=this,i=this.optionItems[e].label;this.$prompt("请修改选项名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:i,inputPattern:/^[A-Za-z\u4e00-\u9fa5\d]+$/,inputErrorMessage:"输入不正确"}).then((function(i){var a=i.value;t.validateOption(a,e)?(t.optionItems[e].label=a,t.$nextTick((function(){console.log("Updated!")}))):t.$message.warning("选项已存在")})).catch((function(){s["Message"].info("已取消")}))},deleteOption:function(e){var t=this;console.log(e),this.$confirm("确定删除该选项?","提示").then((function(){t.optionItems.splice(e,1),t.$message.info("选项已删除")})).catch((function(){t.$message.info("取消删除")}))}}},f=u,p=(i("b07a"),i("2877")),m=Object(p["a"])(f,a,n,!1,null,"0cb8b019",null);t["default"]=m.exports},"9d24":function(e,t,i){},"9eab":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i("1da1"),n=(i("96cf"),i("d364")),l=i("365c"),s={data:function(){return{rules:{name:[{required:!0,message:"请输入字段名称",trigger:"blur"},{pattern:/^[a-z]+[A-Za-z\d]*$/,message:"请以小写英文字母开头，中间可输入字母或数字，禁止中文",trigger:"blur"},{min:2,max:30,message:"请输入至少两个字符",trigger:"blur"}],label:[{required:!0,message:"请输入显示名称",trigger:"blur"},{pattern:/^[A-Za-z\d\u4e00-\u9fa5]+[_-]*/,message:"请以中文、英文字母、数字开头，中间可输入下划线或横杠",trigger:"blur"},{min:2,max:30,message:"请输入至少两个字符",trigger:"blur"}]}}},mounted:function(){this.fieldState===n["a"].EDIT&&this.loadFieldProps()},methods:{createNewField:function(){},modifyOldField:function(e,t){var i=this;return Object(a["a"])(regeneratorRuntime.mark((function a(){var n,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(8==t){a.next=7;break}return a.next=3,Object(l["D"])(e);case 3:n=a.sent,s=n.state,r=n.msg,i.$message({message:r,type:s});case 7:i.$emit("fieldSaved",e);case 8:case"end":return a.stop()}}),a)})))()},cancelSave:function(){this.$emit("cancelSave")},loadFieldProps:function(){this.fieldState,n["a"].EDIT}}}},b07a:function(e,t,i){"use strict";i("9d24")},d364:function(e,t,i){"use strict";var a=1,n=2;t["a"]={NEW:a,EDIT:n}}}]);
//# sourceMappingURL=chunk-2c975ef7.0351f104.js.map