{"version":3,"sources":["webpack:///./src/views/system/field-editor/option-widget-editor.vue?b298","webpack:///./src/views/system/field-editor/option-widget-editor.vue?d47e","webpack:///src/views/system/field-editor/option-widget-editor.vue","webpack:///./src/views/system/field-editor/option-widget-editor.vue?7b5b","webpack:///./src/views/system/field-editor/option-widget-editor.vue","webpack:///./src/views/system/field-editor/field-editor-mixin.js","webpack:///./src/views/system/field-state-variables.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","showingInDialog","_e","_v","ref","attrs","fieldProps","rules","nativeOn","$event","preventDefault","fieldState","model","value","callback","$$v","$set","expression","staticStyle","on","dictortsql","field_sql","data_code","directives","name","rawName","getDtList","loading","_l","item","key","id","name_zh","validators","vt","vtIdx","label","saveField","cancelSave","staticRenderFns","props","entity","Object","fieldName","String","Boolean","type","Number","default","data","dtList","default_show","facttable_id","field_length","file_path","file_size","image_path","is_edit","is_mainfield","is_null","is_system","num_length","order_number","table_name","verifiable","optionItems","hoverIdx","mixins","mounted","getFieldProps","methods","readFieldProps","savedProps","entityCode","$emit","validateOption","forEach","optionTxt","idx","optionIdx","result","getOptionMaxValue","maxValue","addOption","$prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage","insertOption","upOption","tempOption","$message","info","downOption","console","log","length","editOption","inputValue","oldOptionLabel","deleteOption","$confirm","component","fieldEditorMixin","required","message","trigger","pattern","min","max","FieldState","EDIT","loadFieldProps","createNewField","modifyOldField","state","msg","NEW"],"mappings":"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","file":"js/chunk-1a50d844.5e1600ec.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./option-widget-editor.vue?vue&type=style&index=0&id=4486e35f&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{staticClass:\"field-props-container\"},[(!!!_vm.showingInDialog)?_c('el-header',{staticClass:\"field-props-header\"},[_vm._v(\" [单选项]字段属性设置 \")]):_vm._e(),_c('el-main',{staticClass:\"field-props-pane\"},[_c('el-form',{ref:\"editorForm\",attrs:{\"model\":_vm.fieldProps,\"rules\":_vm.rules,\"label-position\":\"left\",\"label-width\":\"220px\",\"size\":\"mini\"},nativeOn:{\"submit\":function($event){$event.preventDefault();}}},[_c('el-form-item',{attrs:{\"label\":\"字段名称\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"disabled\":_vm.fieldState !== 1},model:{value:(_vm.fieldProps.name),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"name\", $$v)},expression:\"fieldProps.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"显示名称\",\"prop\":\"label\"}},[_c('el-input',{model:{value:(_vm.fieldProps.label),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"label\", $$v)},expression:\"fieldProps.label\"}})],1),_c('el-form-item',{attrs:{\"label\":\"字段长度（不超过6位）\"}},[_c('el-input-number',{staticStyle:{\"width\":\"100%\"},attrs:{\"min\":1},model:{value:(_vm.fieldProps.field_length),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"field_length\", $$v)},expression:\"fieldProps.field_length\"}})],1),_c('el-form-item',{attrs:{\"label\":\"下拉选项\"}},[_c('el-radio-group',{on:{\"change\":function($event){_vm.fieldProps.dictortsql == 1\n              ? (_vm.fieldProps.field_sql = '')\n              : (_vm.fieldProps.data_code = '')}},model:{value:(_vm.fieldProps.dictortsql),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"dictortsql\", $$v)},expression:\"fieldProps.dictortsql\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"字典\")]),_c('el-radio',{attrs:{\"label\":2}},[_vm._v(\"自定义SQL\")])],1)],1),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.fieldProps.dictortsql == 1),expression:\"fieldProps.dictortsql == 1\"}],attrs:{\"label\":\"字典\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"filterable\":\"\",\"remote\":\"\",\"reserve-keyword\":\"\",\"placeholder\":\"请输入关键词\",\"remote-method\":_vm.getDtList,\"loading\":_vm.loading},model:{value:(_vm.fieldProps.data_code),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"data_code\", $$v)},expression:\"fieldProps.data_code\"}},_vm._l((_vm.dtList),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name_zh,\"value\":item.id}})}),1)],1),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.fieldProps.dictortsql == 2),expression:\"fieldProps.dictortsql == 2\"}],attrs:{\"label\":\"自定义SQL\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"请输入SQL\",\"type\":\"textarea\"},model:{value:(_vm.fieldProps.field_sql),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"field_sql\", $$v)},expression:\"fieldProps.field_sql\"}})],1),_c('el-form-item',{attrs:{\"label\":\"字段校验函数(可多选)\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"multiple\":\"\",\"allow-create\":\"\",\"filterable\":\"\",\"default-first-option\":\"\",\"popper-append-to-body\":false},model:{value:(_vm.validators),callback:function ($$v) {_vm.validators=$$v},expression:\"validators\"}},_vm._l((_vm.validators),function(vt,vtIdx){return _c('el-option',{key:vtIdx,attrs:{\"label\":vt.label,\"value\":vt.value}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"是否主键\"}},[_c('el-radio-group',{staticStyle:{\"float\":\"right\"},model:{value:(_vm.fieldProps.is_mainfield),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"is_mainfield\", $$v)},expression:\"fieldProps.is_mainfield\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"是\")]),_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"否\")])],1)],1),_c('el-form-item',{attrs:{\"label\":\"是否允许空值\"}},[_c('el-radio-group',{staticStyle:{\"float\":\"right\"},model:{value:(_vm.fieldProps.is_null),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"is_null\", $$v)},expression:\"fieldProps.is_null\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"是\")]),_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"否\")])],1)],1),_c('el-form-item',{attrs:{\"label\":\"允许修改字段\"}},[_c('el-radio-group',{staticStyle:{\"float\":\"right\"},model:{value:(_vm.fieldProps.is_edit),callback:function ($$v) {_vm.$set(_vm.fieldProps, \"is_edit\", $$v)},expression:\"fieldProps.is_edit\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"是\")]),_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"否\")])],1)],1),_c('hr',{staticStyle:{\"border\":\"0\",\"border-top\":\"1px dotted #cccccc\"}}),_c('el-form-item',[_c('el-button',{staticStyle:{\"width\":\"120px\"},attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.saveField}},[_vm._v(\" 保存字段 \")]),(!!_vm.showingInDialog)?_c('el-button',{attrs:{\"size\":\"medium\"},on:{\"click\":_vm.cancelSave}},[_vm._v(\" 取消 \")]):_vm._e()],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-container class=\"field-props-container\">\n    <el-header v-if=\"!!!showingInDialog\" class=\"field-props-header\">\n      [单选项]字段属性设置\n    </el-header>\n    <el-main class=\"field-props-pane\">\n      <el-form\n        ref=\"editorForm\"\n        :model=\"fieldProps\"\n        :rules=\"rules\"\n        label-position=\"left\"\n        label-width=\"220px\"\n        size=\"mini\"\n        @submit.native.prevent\n      >\n        <el-form-item label=\"字段名称\" prop=\"name\">\n          <el-input\n            v-model=\"fieldProps.name\"\n            :disabled=\"fieldState !== 1\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"显示名称\" prop=\"label\">\n          <el-input v-model=\"fieldProps.label\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"字段长度（不超过6位）\" >\n          <el-input-number\n            v-model=\"fieldProps.field_length\"\n            :min=\"1\"\n            style=\"width: 100%\"\n          ></el-input-number>\n        </el-form-item>\n        <!-- <el-form-item label=\"最小值\">\n          <el-input\n            v-model.number=\"fieldProps.fieldViewModel.minValue\"\n            type=\"number\"\n            style=\"width: 100%\"\n          ></el-input>\n        </el-form-item>-->\n        <el-form-item label=\"下拉选项\">\n          <el-radio-group\n            v-model=\"fieldProps.dictortsql\"\n            @change=\"\n              fieldProps.dictortsql == 1\n                ? (fieldProps.field_sql = '')\n                : (fieldProps.data_code = '')\n            \"\n          >\n            <el-radio :label=\"1\">字典</el-radio>\n            <el-radio :label=\"2\">自定义SQL</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-show=\"fieldProps.dictortsql == 1\" label=\"字典\">\n          <el-select\n            v-model=\"fieldProps.data_code\"\n            filterable\n            remote\n            reserve-keyword\n            placeholder=\"请输入关键词\"\n            :remote-method=\"getDtList\"\n            :loading=\"loading\"\n            style=\"width: 100%\"\n          >\n            <el-option\n              v-for=\"item in dtList\"\n              :key=\"item.id\"\n              :label=\"item.name_zh\"\n              :value=\"item.id\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item v-show=\"fieldProps.dictortsql == 2\" label=\"自定义SQL\">\n          <el-input\n            v-model=\"fieldProps.field_sql\"\n            placeholder=\"请输入SQL\"\n            type=\"textarea\"\n            style=\"width: 100%\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"字段校验函数(可多选)\"\n        >\n          <el-select\n            v-model=\"validators\"\n            multiple\n            allow-create\n            filterable\n            default-first-option\n            :popper-append-to-body=\"false\"\n            style=\"width: 100%\"\n          >\n            <el-option\n              v-for=\"(vt, vtIdx) in validators\"\n              :key=\"vtIdx\"\n              :label=\"vt.label\"\n              :value=\"vt.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"是否主键\">\n          <el-radio-group\n            v-model=\"fieldProps.is_mainfield\"\n            style=\"float: right\"\n          >\n            <el-radio :label=\"1\">是</el-radio>\n            <el-radio :label=\"0\">否</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item label=\"是否允许空值\">\n          <el-radio-group v-model=\"fieldProps.is_null\" style=\"float: right\">\n            <el-radio :label=\"1\">是</el-radio>\n            <el-radio :label=\"0\">否</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item label=\"允许修改字段\">\n          <el-radio-group v-model=\"fieldProps.is_edit\" style=\"float: right\">\n            <el-radio :label=\"1\">是</el-radio>\n            <el-radio :label=\"0\">否</el-radio>\n          </el-radio-group>\n        </el-form-item>\n\n        <hr style=\"border: 0; border-top: 1px dotted #cccccc\" />\n        <el-form-item>\n          <el-button\n            type=\"primary\"\n            size=\"medium\"\n            style=\"width: 120px\"\n            @click=\"saveField\"\n          >\n            保存字段\n          </el-button>\n          <el-button v-if=\"!!showingInDialog\" size=\"medium\" @click=\"cancelSave\">\n            取消\n          </el-button>\n        </el-form-item>\n      </el-form>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\n// import {addOptionField, updateOptionField, getField, getOptionItems} from '@/api/system-manager'\nimport { Message } from \"element-ui\";\nimport { copyObj } from \"@/utils/util\";\nimport FieldState from \"@/views/system/field-state-variables\";\nimport { saveField, findDt } from \"@/api\";\nimport { fieldEditorMixin } from \"@/views/system/field-editor/field-editor-mixin\";\n\nexport default {\n  name: \"OptionWidgetEditor\",\n  props: {\n    entity: Object,\n    fieldName: String,\n    showingInDialog: Boolean,\n    fieldState: {\n      type: Number,\n      default: FieldState.NEW,\n    },\n  },\n  data() {\n    return {\n      loading: false,\n      dtList: [],\n      fieldProps: {\n        data_code: \"\",\n        default_show: 0,\n        facttable_id: \"\",\n        field_length: 255,\n        field_sql: \"\",\n        file_path: \"\",\n        file_size: 0,\n        image_path: \"\",\n        is_edit: 0,\n        is_mainfield: 0,\n        is_null: 0,\n        is_system: 0,\n        label: \"\",\n        name: \"\",\n        num_length: 0,\n        order_number: 0,\n        table_name: \"\",\n        type: 5,\n        verifiable: \"\",\n        dictortsql: 1,\n      },\n\n      optionItems: [],\n\n      hoverIdx: -1,\n\n      validators: [],\n      rules:{\n        name:{required:true,message:'请输入字段名',trigger:'blur'},\n        label:{required:true,message:'请输入字段显示名称',trigger:'blur'},\n      }\n    };\n  },\n  mixins: [fieldEditorMixin],\n  mounted() {\n    if (this.fieldState === FieldState.EDIT) {\n      this.getFieldProps();\n    }\n  },\n  methods: {\n    async getDtList(name) {\n      this.loading = true;\n      const { t } = await findDt({ name: name.trim() });\n      this.dtList = t;\n      this.loading = false;\n    },\n    getFieldProps() {\n      // getField(this.fieldName, this.entity)\n      //   .then((res) => {\n      //     if (res.error != null) {\n      //       this.$message({ message: res.error, type: \"error\" });\n      //       return;\n      //     }\n      //     this.readFieldProps(res.data);\n      //   })\n      //   .catch((res) => {\n      //     this.$message({ message: res.message, type: \"error\" });\n      //   });\n    },\n\n    readFieldProps(savedProps) {\n      copyObj(this.fieldProps, savedProps);\n      if (savedProps.entityCode) {\n        this.fieldProps.entityCode = savedProps.entityCode;\n      }\n    },\n\n    async saveField() {\n      let validResult = true;\n      this.fieldProps.table_name = this.entity.name;\n      this.fieldProps.facttable_id = this.entity.id;\n      this.fieldProps.verifiable = this.validators.join(\",\");\n      this.$refs[\"editorForm\"].validate((success) => {\n        if (!success) {\n          validResult = false;\n          return false;\n        }\n      });\n      if (!validResult) return;\n      this.modifyOldField(this.fieldProps)\n\n\n    },\n\n    cancelSave() {\n      this.$emit(\"cancelSave\");\n    },\n\n    validateOption(optionTxt, optionIdx) {\n      let result = true;\n      this.optionItems.forEach((item, idx) => {\n        if (item.label === optionTxt && idx !== optionIdx)\n          // return false  /* forEach中return语句只是终止当前循环进行下一次循环，不能直接跳出函数返回函数结果！！ */\n          result = false;\n      });\n      return result;\n    },\n\n    getOptionMaxValue() {\n      let maxValue = 0;\n      this.optionItems.forEach((item) => {\n        if (item.value > maxValue) {\n          maxValue = item.value;\n        }\n      });\n      return maxValue;\n    },\n\n    addOption() {\n      this.$prompt(\"请输入选项名称\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        inputPattern:\n          /^[A-Za-z\\u4e00-\\u9fa5\\d]+$/ /* 匹配由字母大小写、汉字或数字组成的字符串 */,\n        inputErrorMessage: \"输入不正确\",\n      })\n        .then(({ value }) => {\n          if (this.validateOption(value, -1)) {\n            let newOptionValue = this.getOptionMaxValue() + 1;\n            let newOption = {\n              label: value,\n              value: newOptionValue,\n              saved: false,\n            };\n            this.optionItems.push(newOption);\n            this.$nextTick(() => {\n              console.log(\"Updated!\");\n            });\n          } else {\n            this.$message.warning(\"选项已存在\");\n          }\n        })\n        .catch(() => {\n          Message.info(\"已取消\");\n        });\n    },\n\n    insertOption(optionIdx) {\n      this.$prompt(\"请输入选项名称\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        inputPattern:\n          /^[A-Za-z\\u4e00-\\u9fa5\\d]+$/ /* 匹配由字母大小写、汉字或数字组成的字符串 */,\n        inputErrorMessage: \"输入不正确\",\n      })\n        .then(({ value }) => {\n          if (this.validateOption(value, -1)) {\n            let newOptionValue = this.getOptionMaxValue() + 1;\n            let newOption = {\n              label: value,\n              value: newOptionValue,\n              saved: false,\n            };\n            this.optionItems.splice(optionIdx + 1, 0, newOption);\n            this.$nextTick(() => {\n              console.log(\"Updated!\");\n            });\n          } else {\n            this.$message.warning(\"选项已存在\");\n          }\n        })\n        .catch(() => {\n          Message.info(\"已取消\");\n        });\n    },\n\n    upOption(optionIdx) {\n      if (optionIdx === 0) {\n        this.$message.info(\"已到最上\");\n        return;\n      }\n\n      let tempOption = this.optionItems[optionIdx];\n      this.$set(this.optionItems, optionIdx, this.optionItems[optionIdx - 1]);\n      this.$set(this.optionItems, optionIdx - 1, tempOption);\n    },\n\n    downOption(optionIdx) {\n      console.log(\n        \"length: \" + this.optionItems.length + \", current idx: \" + optionIdx\n      );\n      if (optionIdx === this.optionItems.length - 1) {\n        this.$message.info(\"已到最下\");\n        return;\n      }\n\n      let tempOption = this.optionItems[optionIdx];\n      this.$set(this.optionItems, optionIdx, this.optionItems[optionIdx + 1]);\n      this.$set(this.optionItems, optionIdx + 1, tempOption);\n    },\n\n    editOption(optionIdx) {\n      let oldOptionLabel = this.optionItems[optionIdx].label;\n      this.$prompt(\"请修改选项名称\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        inputValue: oldOptionLabel,\n        inputPattern:\n          /^[A-Za-z\\u4e00-\\u9fa5\\d]+$/ /* 匹配由字母大小写、汉字或数字组成的字符串 */,\n        inputErrorMessage: \"输入不正确\",\n      })\n        .then(({ value }) => {\n          if (this.validateOption(value, optionIdx)) {\n            this.optionItems[optionIdx].label = value;\n            this.$nextTick(() => {\n              console.log(\"Updated!\");\n            });\n          } else {\n            this.$message.warning(\"选项已存在\");\n          }\n        })\n        .catch(() => {\n          Message.info(\"已取消\");\n        });\n    },\n\n    deleteOption(optionIdx) {\n      console.log(optionIdx);\n      this.$confirm(\"确定删除该选项?\", \"提示\")\n        .then(() => {\n          //TODO：后台需要检查改选项是否已被实体记录所引用！！\n          this.optionItems.splice(optionIdx, 1);\n          this.$message.info(\"选项已删除\");\n        })\n        .catch(() => {\n          this.$message.info(\"取消删除\");\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/styles/form-layout/field-editor-common.scss\";\n\n.box-card {\n  font-size: 14px;\n\n  ::v-deep .el-card__body {\n    height: 220px;\n    overflow: auto;\n  }\n\n  .option-item {\n    float: right;\n    height: 22px;\n    line-height: 22px;\n    position: relative;\n\n    .option-item-insert {\n      position: absolute;\n      top: -8px;\n      left: -100px;\n    }\n\n    .option-item-up {\n      position: absolute;\n      top: -6px;\n      left: -86px;\n    }\n\n    .option-item-down {\n      position: absolute;\n      top: -7px;\n      left: -66px;\n    }\n\n    .option-item-edit {\n      position: absolute;\n      top: -7px;\n      left: -42px;\n    }\n\n    .option-item-delete {\n      position: absolute;\n      top: -8px;\n      left: -18px;\n    }\n  }\n}\n\n.clear-fix:before,\n.clear-fix:after {\n  display: table;\n  content: \"\";\n}\n\n.clear-fix:after {\n  clear: both;\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./option-widget-editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./option-widget-editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./option-widget-editor.vue?vue&type=template&id=4486e35f&scoped=true&\"\nimport script from \"./option-widget-editor.vue?vue&type=script&lang=js&\"\nexport * from \"./option-widget-editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./option-widget-editor.vue?vue&type=style&index=0&id=4486e35f&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4486e35f\",\n  null\n  \n)\n\nexport default component.exports","import FieldState from \"@/views/system/field-state-variables\";\nimport {saveField} from \"@/api\";\n// import {addField, getField, updateField} from \"@/api/system-manager\";\n// import { copyObj } from \"@/utils/util\";\n\nexport const fieldEditorMixin = {\n  data() {\n    return {\n      rules: {\n        name: [\n          { required: true, message: \"请输入字段名称\", trigger: \"blur\" },\n          {\n            pattern: /^[a-z]+[A-Za-z\\d]*$/,\n            message: \"请以小写英文字母开头，中间可输入字母或数字，禁止中文\",\n            trigger: \"blur\",\n          },\n          { min: 2, max: 30, message: \"请输入至少两个字符\", trigger: \"blur\" },\n        ],\n        label: [\n          { required: true, message: \"请输入显示名称\", trigger: \"blur\" },\n          {\n            pattern: /^[A-Za-z\\d\\u4e00-\\u9fa5]+[_-]*/,\n            message: \"请以中文、英文字母、数字开头，中间可输入下划线或横杠\",\n            trigger: \"blur\",\n          },\n          { min: 2, max: 30, message: \"请输入至少两个字符\", trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  mounted() {\n    if (this.fieldState === FieldState.EDIT) {\n      this.loadFieldProps();\n    }\n  },\n  methods: {\n    createNewField() {\n      // addField(this.fieldProps, this.entity)\n      //   .then((res) => {\n      //     if (res.error != null) {\n      //       this.$message({ message: res.error, type: \"error\" });\n      //       return;\n      //     }\n      //     this.$message.success(\"保存成功\");\n      //     this.$emit(\"fieldSaved\");\n      //   })\n      //   .catch((res) => {\n      //     this.$message({ message: res.message, type: \"error\" });\n      //   });\n    },\n\n    async modifyOldField(data) {\n      console.log(data)\n      const { state, msg } = await saveField(data);\n      this.$message({\n        message: msg,\n        type: state,\n      });\n      this.$emit(\"fieldSaved\");\n    },\n\n    cancelSave() {\n      this.$emit(\"cancelSave\");\n    },\n\n    loadFieldProps() {\n      if (this.fieldState !== FieldState.EDIT) {\n        return;\n      }\n\n      // getField(this.fieldName, this.entity)\n      //   .then((res) => {\n      //     if (res.error != null) {\n      //       this.$message({ message: res.error, type: \"error\" });\n      //       return;\n      //     }\n\n      //     //console.log(res.data)\n      //     copyObj(this.fieldProps, res.data);\n      //     if (!this.fieldProps.fieldViewModel) {\n      //       this.fieldProps.fieldViewModel = {};\n      //     }\n      //     if (!this.fieldProps.referenceSetting) {\n      //       this.fieldProps.referenceSetting = [];\n      //     }\n\n      //     //console.log( this.fieldProps )\n      //   })\n      //   .catch((res) => {\n      //     this.$message({ message: res.message, type: \"error\" });\n      //   });\n    },\n  },\n};\n","/* 字段状态：1新建，2编辑 */\nconst NEW = 1\nconst EDIT = 2\n\nexport default {\n  NEW,\n  EDIT,\n}\n"],"sourceRoot":""}